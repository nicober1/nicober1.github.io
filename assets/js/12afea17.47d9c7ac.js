"use strict";(self.webpackChunkfluentblogs=self.webpackChunkfluentblogs||[]).push([[5331],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>m});var a=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=a.createContext({}),s=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=s(e.components);return a.createElement(l.Provider,{value:n},e.children)},g="mdxType",y={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},w=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),g=s(t),w=o,m=g["".concat(l,".").concat(w)]||g[w]||y[w]||r;return t?a.createElement(m,i(i({ref:n},p),{},{components:t})):a.createElement(m,i({ref:n},p))}));function m(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,i=new Array(r);i[0]=w;var c={};for(var l in n)hasOwnProperty.call(n,l)&&(c[l]=n[l]);c.originalType=e,c[g]="string"==typeof e?e:o,i[1]=c;for(var s=2;s<r;s++)i[s]=t[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}w.displayName="MDXCreateElement"},15899:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>l,default:()=>m,frontMatter:()=>c,metadata:()=>s,toc:()=>g});var a=t(87462),o=t(63366),r=(t(67294),t(3905)),i=["components"],c={keywords:["Playwright"]},l=void 0,s={unversionedId:"Playwright",id:"Playwright",title:"Playwright",description:"",source:"@site/docs/Playwright.md",sourceDirName:".",slug:"/Playwright",permalink:"/docs/Playwright",draft:!1,tags:[],version:"current",frontMatter:{keywords:["Playwright"]},sidebar:"myAutogeneratedSidebar",previous:{title:"Investment Banking Notes",permalink:"/docs/Investment Banking Notes"},next:{title:"Python",permalink:"/docs/Python"}},p={},g=[],y={toc:g},w="wrapper";function m(e){var n=e.components,t=(0,o.Z)(e,i);return(0,r.kt)(w,(0,a.Z)({},y,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'# Save storage state into the file.\nstorage = context.storage_state(path="state.json")\n\n# Create a new context with the saved storage state.\ncontext = browser.new_context(storage_state="state.json")\n\n$Env:PLAYWRIGHT_BROWSERS_PATH="$Env:USERPROFILE\\pw-browsers"\npip install playwright\nplaywright install\n\n\n$Env:PLAYWRIGHT_BROWSERS_PATH="$Env:USERPROFILE\\pw-browsers"\npython playwright_script.py\n\nPLAYWRIGHT_SKIP_BROWSER_GC=1\n\npage.wait_for_timeout(5000)\n\nfrom playwright.sync_api import expect\n\nexpect.set_options(timeout=10_000)\nexpect(page.get_by_text("Name")).to_be_visible(timeout=10_000)\n\nplaywright codegen demo.playwright.dev/todomvc\n\n\nfrom playwright.sync_api import Playwright, sync_playwright, expect\n\n\ndef run(playwright: Playwright) -> None:\n    browser = playwright.chromium.launch(headless=False)\n    context = browser.new_context()\n    page = context.new_page()\n    page.goto("about:blank")\n    page.goto("chrome-error://chromewebdata/")\n    page.locator("div").filter(has_text="Your connection is not private Attackers might be trying to steal your informati").first.click()\n    page.get_by_role("button", name="Advanced").click()\n    page.get_by_role("link", name="Proceed to centrali.mandg.com (unsafe)").click()\n    page.get_by_placeholder("user@domain.com").click()\n    page.get_by_placeholder("user@domain.com").fill("username")\n    page.get_by_role("button", name="Next").click()\n    page.locator("#i0118").fill("password")\n    page.get_by_role("button", name="Sign in").click()\n    page.get_by_role("button", name="Approve a request on my Microsoft Authenticator app").click()\n    page.goto("https://login.microsoftonline.com/common/SAS/ProcessAuth")\n\n    page.get_by_role("button", name="Browse ").click()\n    page.get_by_role("link", name="All applications").click()\n    page.get_by_role("link", name="App ").click()\n    page.get_by_role("button", name="Click here").click()\n    page.get_by_role("link", name="Categories").click()\n    page.get_by_role("link", name="ava").click()\n    page.get_by_role("menuitem", name="Profile").click()\n    page.get_by_text("what").click()\n    page.get_by_text("what", exact=True).click()\n    page.locator("div").filter(has_text=re.compile(r"^tech$")).nth(2).click()\n    page.get_by_text("what", exact=True).click()\n    page.get_by_test_id("update-").click()\n    page.get_by_role("button", name="close").click()\n    page.get_by_role("link", name="logo").click()\n    page.locator(".text-primary").click()\n    page.get_by_role("link", name="about").click()\n    page.get_by_text("Go to").click()\n    page.get_by_role("link", name="App store").click()\n    page.get_by_role("link", name="My ").click()\n    page.get_by_role("link", name="All ").click()\n    page.get_by_role("link", name="cat").click()\n    page.get_by_role("link", name="col").click()\n    page.get_by_test_id("what").click()\n    page.locator(".img-screen").first.click()\n    page.get_by_role("dialog").click()\n    page.get_by_role("dialog").click()\n    page.get_by_placeholder("Search for ").click()\n    page.get_by_placeholder("Search for ").fill("what")\n    page.get_by_placeholder("Search for ").press("Enter")\n    page.locator("#btn-item-3").click()\n    page.locator("#btn-item-5").click()\n    page.get_by_role("link", name="My ").click()\n    page.get_by_role("link", name="App ").click()\n    page.get_by_role("link", name="App ").click(button="right")\n    page.locator("div").filter(has_text=re.compile(r"^what$")).get_by_role("link", name="View all").click()\n    page.locator("div:nth-child(2) > div > .img-screen").click()\n    page.get_by_role("link", name="name").click()\n\n\n    # ---------------------\n    context.close()\n    browser.close()\n\n\nwith sync_playwright() as playwright:\n    run(playwright)\n\n\n\nimport os\n# Get session storage and store as env variable\nsession_storage = page.evaluate("() => JSON.stringify(sessionStorage)")\nos.environ["SESSION_STORAGE"] = session_storage\n\n# Set session storage in a new context\nsession_storage = os.environ["SESSION_STORAGE"]\ncontext.add_init_script("""(storage => {\n  if (window.location.hostname === \'example.com\') {\n    const entries = JSON.parse(storage)\n    for (const [key, value] of Object.entries(entries)) {\n      window.sessionStorage.setItem(key, value)\n    }\n  }\n})(\'""" + session_storage + "\')")\n\n\nfrom playwright.sync_api import sync_playwright\n\n\npath_to_extension = "./my-extension"\nuser_data_dir = "/tmp/test-user-data-dir"\n\n\ndef run(playwright):\n    context = playwright.chromium.launch_persistent_context(\n        user_data_dir,\n        headless=False,\n        args=[\n            f"--disable-extensions-except={path_to_extension}",\n            f"--load-extension={path_to_extension}",\n        ],\n    )\n    if len(context.background_pages) == 0:\n        background_page = context.wait_for_event(\'backgroundpage\')\n    else:\n        background_page = context.background_pages[0]\n\n    # Test the background page as you would any other page.\n    context.close()\n\n\nwith sync_playwright() as playwright:\n    run(playwright)\n\n\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp"},'playwright codegen demo.playwright.dev/todomvc\n\nusing var playwright = await Playwright.CreateAsync();\n        await using var browser = await playwright.Chromium.LaunchAsync(new BrowserTypeLaunchOptions\n        {\n            Headless = false,\n        });\n        var context = await browser.NewContextAsync();\n\n        var page = await context.NewPageAsync();\n\n        await page.GotoAsync("about:blank");\n\n        await page.GotoAsync("chrome-error://chromewebdata/");\n\n        await page.Locator("div").Filter(new() { HasText = "Your connection is not private Attackers might be trying to steal your informati" }).First.ClickAsync();\n\nawait page.GotoAsync("https://google.com");\nawait page.GetByPlaceholder("user@domain.com").ClickAsync();\nawait page.GetByRole(AriaRole.Button, new() { Name = "Next" }).ClickAsync();\nawait page.GetByRole(AriaRole.Link, new() { Name = "Proceed to centrali.mandg.com (unsafe)" }).ClickAsync();\n\nawait page.GetByPlaceholder("user@domain.com").FillAsync("username");\nawait page.Locator("#i0118").FillAsync("password");\n\nawait page.GetByRole(AriaRole.Button, new() { Name = "Browse what" }).ClickAsync();\n\n        await page.GetByRole(AriaRole.Link, new() { Name = "All what" }).ClickAsync();\n\n        await page.GetByRole(AriaRole.Link, new() { Name = "App what" }).ClickAsync();\n\n        await page.GetByRole(AriaRole.Button, new() { Name = "Click here" }).ClickAsync();\n\n        await page.GetByRole(AriaRole.Link, new() { Name = "what" }).ClickAsync();\n\n        await page.GetByRole(AriaRole.Link, new() { Name = "what what what" }).ClickAsync();\n\n        await page.GetByRole(AriaRole.Menuitem, new() { Name = "what" }).ClickAsync();\n\n        await page.GetByText("what what").ClickAsync();\n\n        await page.GetByText("what what", new() { Exact = true }).ClickAsync();\n\n        await page.Locator("div").Filter(new() { HasTextRegex = new Regex("^what$") }).Nth(2).ClickAsync();\n\n        await page.GetByText("what", new() { Exact = true }).ClickAsync();\n\n        await page.GetByTestId("what").ClickAsync();\n\n        await page.GetByRole(AriaRole.Button, new() { Name = "close" }).ClickAsync();\n\n        await page.GetByRole(AriaRole.Link, new() { Name = "what" }).ClickAsync();\n\n        await page.Locator(".text-primary").ClickAsync();\n\n        await page.GetByRole(AriaRole.Link, new() { Name = "what" }).ClickAsync();\n\n        await page.GetByText("Go to portal").ClickAsync();\n\n        await page.GetByRole(AriaRole.Link, new() { Name = "App what" }).ClickAsync();\n\n        await page.GetByRole(AriaRole.Link, new() { Name = "My what" }).ClickAsync();\n\n        await page.GetByRole(AriaRole.Link, new() { Name = "All what" }).ClickAsync();\n\n        await page.GetByRole(AriaRole.Link, new() { Name = "what" }).ClickAsync();\n\n        await page.GetByRole(AriaRole.Link, new() { Name = "what" }).ClickAsync();\n\n        await page.GetByTestId("what").ClickAsync();\n\n        await page.Locator(".img-screen").First.ClickAsync();\n\n        await page.GetByRole(AriaRole.Dialog).ClickAsync();\n\n        await page.GetByRole(AriaRole.Dialog).ClickAsync();\n\n        await page.GetByPlaceholder("Search for apps").ClickAsync();\n\n        await page.GetByPlaceholder("Search for apps").FillAsync("esg");\n\n        await page.GetByPlaceholder("Search for apps").PressAsync("Enter");\n\n        await page.Locator("#btn-item-3").ClickAsync();\n\n        await page.Locator("#btn-item-5").ClickAsync();\n\n        await page.GetByRole(AriaRole.Link, new() { Name = "My " }).ClickAsync();\n\n        await page.GetByRole(AriaRole.Link, new() { Name = "App store" }).ClickAsync();\n\n        await page.GetByRole(AriaRole.Link, new() { Name = "App store" }).ClickAsync(new LocatorClickOptions\n        {\n            Button = MouseButton.Right,\n        });\n\n        await page.Locator("div").Filter(new() { HasTextRegex = new Regex("^New all$") }).GetByRole(AriaRole.Link, new() { Name = "View all" }).ClickAsync();\n\n        await page.Locator("div:nth-child(2) > div > .img-screen").ClickAsync();\n\n        await page.GetByRole(AriaRole.Link, new() { Name = "All " }).ClickAsync();\n\n\n\n\n\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"# pylint: disable-all\nfrom playwright.sync_api import sync_playwright\nimport time\n\ndef launch_browser(url, path):\n    with sync_playwright() as playwright:\n        # browser = playwright.chromium.launch(headless=False,slow_mo=1000)\n        browser = playwright.chromium.launch()\n        context = browser.new_context(ignore_https_errors=True)\n        page = context.new_page()\n        page.goto(url,wait_until='commit',timeout=100000)\n        page.wait_for_timeout(30000)\n        page.screenshot(path=path, full_page=True)\n        browser.close()\n\nlaunch_browser('https://edition.cnn.com/', './static/scr/cnn.png')\nlaunch_browser('https://www.bbc.com/', './static/scr/bbc.png')\nlaunch_browser('https://www.cnbc.com/', './static/scr/cnbc.png')\n\n")))}m.isMDXComponent=!0}}]);